# 2026-01-21｜Q-realign：从激活空间出发，把“安全修复”塞进量化（PTQ）流程（digest）

> 材料类型：论文（可核验） + 二手解读（用户粘贴）  
> 核心主张：微调导致的“安全退化”不是（主要）数据脏，而是 **中间层表示几何被搅乱**；因此可在**部署必经的 PTQ（量化）阶段**做一次低成本、方向性的“再分离（re-separation）”，把恶意输入推回拒答子空间。

---

## 0) 来源与可回查锚点

- **用户材料**：用户粘贴中文解读（含图，但非原始来源）
- **原始论文（可核验）**：
  - arXiv：`https://arxiv.org/abs/2601.08089`（Q-realign: Piggybacking Realignment on Quantization for Safe and Efficient LLM Deployment，2026-01-13；web search，2026-01-21）
- **代码仓库**：
  - 截止 2026-01-21：未找到公开 repo（web search，2026-01-21）

---

## 1) 这篇材料在说什么（只留结构性主张）

- **问题**：下游微调会“漂移”预训练模型的安全对齐（拒答率下降 / harmful score 上升），且不一定来自脏数据。
- **诊断视角转移**：不看输出文本，先看 **中后层激活（activations）** 的空间结构。
  - 对齐良好时：良性 vs 恶意输入在深层激活空间可线性分离；从中间层“解码”也能看到拒答语义。
  - 微调后：恶意激活更分散并侵入良性区域 → 可分性下降 → 行为层面的拒答退化。
- **工程解法**：不回到训练链路，在部署前 PTQ 中加入 **条件化目标**：
  - 良性样本：保持能力（激活/行为重建）
  - 恶意样本：加入 re-separation 损失，把激活推离“安全边界”，恢复分离

---

## 2) 可抽取资产（Definitions / Variables / Mechanisms）

### 2.1 定义

- **表示可分性（separability）**：良性/恶意输入在某层激活空间的“可线性分离程度”（论文中提供空间/语义两类度量）。
- **安全边界（linear boundary / probe）**：在“安全对齐良好”的基座模型上，用轻量线性分类器（如稀疏逻辑回归）学到的分界面。
- **再分离损失（re-separation loss）**：在 PTQ 过程中，对恶意样本施加的“推离边界”目标，使恶意激活回到拒答侧。
- **部署期结构干预**：把量化/剪枝/蒸馏等“性能工具”重新定义为最后一次低成本可控改形的干预窗口。

### 2.2 关键变量（后续验证/反证会用到）

- **安全恢复幅度**：hateful/harmful 指标、拒答率、越狱成功率（attack set）
- **能力保持**：下游任务指标（如分类/推理/指令遵循）
- **成本**：单卡耗时、显存占用、是否逐层处理、是否依赖微调过程信号
- **泛化性**：跨模型（LLaMA2/Gemma/Qwen）、跨任务（Alpaca/SST-2/GSM8K）、跨攻击分布
- **可被规避性**：白盒/自适应攻击是否能绕开“线性边界”假设
- **量化形态敏感性**：W8A8 vs 更低 bit，是否仍能工作

### 2.3 机制（为什么它可能有效）

- **把“对齐”当几何结构**：对齐不是只在输出层的策略，而是中后层表示已形成“拒答子空间/分离结构”。
- **微调是结构扰动**：微调不必删除安全能力，但会让表示混叠 → 模型“语义上不确定这是该拒绝的输入”。
- **PTQ 本来就在动结构**：量化会改变激活分布与误差传播；因此可用“带方向的约束”把误差的方向变成“拉开距离”。

---

## 3) 关键主张（Claims）与可验证预测（Predictions）

1) **微调导致的安全退化可由中间层可分性下降解释**  
   - 预测：对齐良好模型在中后层可线性分离；微调后该可分性显著下降（可复现）。
2) **在 PTQ 中加入 re-separation 可恢复安全指标且不显著牺牲任务性能**  
   - 预测：在相同量化设置下，安全指标显著优于“只做重建”的 PTQ 基线；任务性能接近。
3) **部署成本优势显著**（固定成本，不随微调步数线性增长）  
   - 预测：单卡（如 4090）可在 <1h 完成 7B 量级模型的量化+安全恢复；显存门槛低（逐层）。

---

## 4) 不确定性与盲区（决定成败）

- **线性边界的表达上限**：若恶意/良性在真实分布中高度非线性混叠，线性探针可能不足。
- **攻击自适应**：攻击者若知道边界/损失形式，是否可构造绕开分离的 prompt？
- **误伤风险**：对“灰区请求”（安全但敏感）是否造成过度拒答？（需要误拒率与可解释错误分析）
- **低比特量化的稳定性**：在更激进压缩（如 4bit/更低）是否仍能兼顾能力与安全？

---

## 5) 应该被写入哪里（Routing）

- **World understanding**：`world_understanding/q_realign_quantization_deployment_safety_realignment.md`（用 `frameworks/06_time_travel_endgame_simulator.md` 做 Gate 分析）
- **Meta**：新增猜想 `H-0019`（“部署期 PTQ 可成为安全再对齐的低成本结构干预窗口”）
- **Distilled**：更新 `distilled/core_hypotheses.md` 与 `distilled/opportunity_map.md`（Gate 2 候补跟踪）

