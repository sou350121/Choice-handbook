# 自动化交易的基础模型（HRT / HAIL）：在“智能 vs 速度”的 Pareto 前沿上做工程

> 这篇把 HRT（HAIL，Marc Khoury）在 ICML 2025 的分享梳理成可执行的世界理解：市场微观结构的对象是什么？为什么“更聪明”与“更快”天然冲突？时间切片为什么会抹平 alpha？预测视界为何决定你能用多大的模型？以及：你该如何写出退出条件与下一步实验。
>
> 来源 digest：`sources/2026-01-19_hrt_hail_foundation_models_automated_trading_icml_2025.md`（演讲链接：`https://icml.cc/virtual/2025/46791`）

---

## 概述（这篇解决什么选择/误区）

这篇主要解决三类常见误区：

- **误区 A：把“价格”当成单一数值**：忽视 LOB 这一市场供需意图的主对象。
- **误区 B：只谈模型不谈延迟**：在自动化交易里，推理延迟会直接把 alpha 吃掉（滑点/错过机会），模型再聪明也可能不可上线。
- **误区 C：只谈回测不谈仿真缺口**：市场非平稳、非零和且无完美仿真器；回测无法复刻市场冲击与对手反应。

核心结论：**金融“基础模型”不是单点算法突破，而是算法 + 数据 + 基础设施 + 延迟工程的系统工程**。

---

## 框架/模型（1–3 个，给出使用条件）

### 1) Smart vs Fast：交易系统的 Pareto 前沿

- **更聪明（Smarter）**：更复杂模型可捕捉非线性/隐性特征，提取更深 alpha
- **更快（Faster）**：更低延迟系统能抢显性机会、减少滑点
- **硬约束**：更多 compute 通常意味着更高推理延迟（inference latency）

**适用**：做 tick/秒级到分钟级的预测与执行系统，尤其是对延迟敏感的策略。  
**不适用**：你做的是低频、延迟不敏感、成交影响较小的场景（但仍需验证）。

### 2) 时间 vs 事件：tokenization 决定你看见什么

- 金融事件是**非均匀**的：某些时刻 burst，其他时刻稀疏
- **时间切片（time-based）**容易“平滑掉”微观结构细节
- **事件切片（event/tick-based）**更贴近市场本质，但对模型架构与推理效率提出更高要求

**适用**：你在处理 LOB、逐笔成交、逐事件更新等微观结构任务。  
**不适用**：宏观周期、日级别、事件密度低且你明确不需要微观结构细节。

### 3) Horizon 困境：视界决定信噪比、延迟与有效样本量

选择预测目标会“锁死”你能用的模型复杂度：

- **极短 horizon（下一笔/下一跳）**：信号相对更可用，但延迟要求极高 → 模型必须轻量
- **长 horizon（小时级）**：允许大模型，但有效样本量下降 + 信噪比更低 → 过拟合风险上升
- **中间地带（如 1 分钟）**：看似信号丰富，但可能同时卡在“大模型推理太慢”的工程瓶颈

**适用**：你在选目标函数、评估 scaling law 是否值得、决定数据与算力投入方向。  
**不适用**：你把目标固定死且不愿为它改变系统结构与评测方式。

---

## 材料分类与索引

- **类型**：演讲内容的二手梳理总结
- **主题**：市场微观结构（LOB）、策略（做市/吃单）、延迟工程、模型架构选型、tokenization、预测视界、scaling laws、无完美仿真器、特征工程
- **可信度**：
  - 第一手/二手：二手梳理（需以演讲/公开材料核验关键数字）
  - 可追溯性：可追溯到演讲链接与梳理文本；细节可能被简化
  - 利益相关：交易公司叙事可能强调自身优势（数据/算力/工程）
- **输出去向**：`world_understanding/`；可衍生 `checklists/`

---

## 降维解剖（把“交易基础模型”压成可计算骨架）

### 第一性扫描（事实/约束/资源/风险）

- LOB 定义了价格的“结构”，并承载供需意图
- 延迟是硬约束：推理越慢，机会越容易被市场吞噬
- 市场非平稳且对手会反应：回测无法完美复刻冲击与博弈
- 金融信噪比低：不靠人类直觉基线，需要从一开始就超人化

### 根本问题 $\mathcal{O}$：你在最大化什么？

一个可执行的目标函数版本：

- **最大化**：风险调整后的预期收益（alpha） × 可实现性（执行成功率）
- **约束**：推理延迟预算、滑点与冲击成本、非平稳鲁棒性、合规与风险上限、工程可维护性

### 核心变量（≤10）+ 算子（≤5）

- **变量**：spread、流动性、订单到达强度（burst）、horizon、信噪比、有效样本量、推理延迟、成交滑点、逆向选择风险、回测-实盘偏差。
- **算子**：特征提取（流→向量）、表示学习（time/event）、预测（方向/强度）、执行（下单/撤单）、评测（回测+在线监控）。

### 阶段切换信号（3 个）

1) 你能用同一套评测把“更聪明”与“更快”的权衡量化（而不是拍脑袋）  
2) 你能证明 tokenization 的改变带来可重复的收益（而非过拟合）  
3) 你能把回测与实盘偏差拆成可解释的组件（冲击/延迟/对手反应）

---

## 比较思考（发展史 × 情景 × 信号）

### 结构相似的祖先（机制类比）

- **语音/视频流系统**：编码方式（时间 vs 事件）决定你保留什么信息；延迟预算是硬约束。
- **实时推荐/广告竞价**：模型更强但延迟更高时，收益可能被竞价与时延吞掉，系统工程决定上限。

### 未来情景（保守/基准/激进）+ 观察信号（假设/推演）

- **保守**：大模型主要用于中低频或离线研究，低延迟场景仍由强归纳偏置的轻量模型主导。  
  - 信号：推理成本下降不够快；低延迟系统更多依赖手工结构与特征。
- **基准**：架构创新（更高效 attention/更强记忆）+ 工程优化，让更大模型进入更短 horizon。  
  - 信号：出现稳定可复现的低延迟 transformer/混合架构；线上收益可回归。
- **激进**：形成跨资产通用的“金融基础模型”，在多个 horizon 上都能给出可交易的优势。  
  - 信号：跨资产迁移有效；在非平稳切换中保持鲁棒；对手适应下仍可持续。

---

## 年代镜头（当时的人看到什么）

- **当时约束**：市场是对手博弈且非平稳；“更聪明”的模型经常被“更快/更稳”的系统工程吞噬收益。  
- **当时可见信号**：大模型能力快速上升，但推理延迟、成本与回归难度仍是硬边界。  
- **当时主流信念**：要么押速度（低延迟工程），要么押智能（更强模型）；两派都低估对方的硬约束。  
- **当时盲区**：回测看起来很美不代表能活在真实市场；评测体系与风险治理才是护城河。

## 分叉点（当时可选的路径与代价）

- **路径 A：速度优先（低延迟/事件驱动）**  
  - 代价：模型容量受限，智能上限可能被锁死；需要长期工程复利与微小优势的累积。
- **路径 B：智能优先（更大模型/更长视界）**  
  - 代价：延迟与成本上升、样本有效性下降、过拟合风险变大；必须靠更强回归与风控兜底。
- **路径 C：混合路线（快系统 + 慢脑）**  
  - 代价：系统复杂度更高，但更符合金融：不同 horizon 用不同工具，组合在一起才可交付。

## 收敛（我更确定的未来来自哪里）

- **更确定 1（不变量）**：金融优势最终是“系统工程优势”（数据/回归/风险/执行/成本），而不是单点模型分数。  
  - **信号**：线上收益可回归、回归集可复现、风险事件有可解释归因。
- **更确定 2（约束）**：延迟与滑点是硬约束；任何模型都必须在延迟预算下证明净优势。  
  - **信号**：收益对延迟/成本的敏感性曲线是否被量化并持续监控。
- **更确定 3（机制）**：多目标 Pareto（聪明 vs 快 vs 稳）将长期存在；能在 Pareto 上移动的团队才有复利。  
  - **信号**：同等风险下收益上移、或同等收益下风险/成本下降，且跨 regime 可回归。

## 尽头坐标

### 远方尽头

在可控风险与可回归评测下，把“可交易的预测能力”系统性地产出，并能在不同资产与不同市场状态下迁移与迭代。

### 现实尽头（停止处）

- **延迟尽头**：模型收益被推理延迟与滑点吞噬
- **视界尽头**：horizon 太长导致有效样本量不足、过拟合；太短又跑不动复杂模型
- **评测尽头**：回测无法复刻冲击/对手反应，导致线上崩塌
- **数据尽头**：清洗、对齐与特征提取不足，模型看见的是噪音

### 退出条件 + 重启条件

- **退出条件（停机点）**
  - 在固定延迟预算下，模型升级带来的收益 < 滑点/冲击增加带来的损失（连续 ___ 周）
  - 回测收益与线上收益持续背离（偏差 > ___%，持续 ___ 次版本）
  - 模型对市场状态切换敏感，切换后损失超过风险上限（___）
- **重启条件**
  - 建立能解释偏差的归因链（延迟/冲击/对手反应/数据质量）
  - 形成 tokenization/架构/执行三者协同的改进方案，并在回归集上稳定收益

---

## 下一步（最小动作）

- 用同一套指标板画出 3 个点：**快小模型 / 慢大模型 / 混合路线**（收益、滑点、P95/P99 延迟、风险上限），先把 trade-off 量化。  
- 只做一个 A/B：time-based vs event-based tokenization，固定预算与评测口径，确认收益差异是否可回归。

---

## 可投資標的（Long / Hedge / Short）

> 仅用于把“世界理解”翻译成可执行的交易表达，不构成投资建议。

**机制押注（假设/策略表达）**：在自动化交易里，“更聪明”与“更快”在 Pareto 前沿上权衡；长期优势更像系统工程（数据 + 基础设施 + 延迟工程 + 风险与回归体系），而不是单点模型分数。

### Long（做多：我相信它会发生）

- **主题**：交易基础设施与“速度/数据”生态（交易所、数据服务、清算、低延迟网络）  
  - **代表性标的（2–5）**：`CME`（清算/期货生态）、`ICE`（交易所 + 数据）、`NDAQ`（交易所 + 市场技术）、`CBOE`（期权/波动率生态）、`ANET`（数据中心网络/低延迟）  
  - **加密（可选）**：若你把“市场结构演进 + 波动”作为暴露，可用 `BTC` 作为 beta，再用期权/仓位管理处理尾部

### Hedge（对冲：我怕的是什么）

- **风险 1：市场状态切换/波动率上升** → **工具**：指数 put / put spread（优先限损）；或波动率工具（注意期限结构与滚动损耗）  
- **风险 2：利率/美元冲击导致风险资产相关性上升** → **工具**：久期/美元相关对冲（ETF/期货视账户能力）  
- **风险 3：监管/结构性规则变化（交易/清算/数据）** → **工具**：用“篮子持仓”替代单一公司暴露，降低事件风险

### Short（做空：我不相信它会发生，或认为被高估）

- **方向**：过度依赖回测叙事、忽视延迟/冲击/对手反应的“高杠杆策略神话”。  
  - **表达方式**：更适合用“仓位结构 + 严格限损”而非点名单一标的；若要表达整体回撤风险，用指数 put 或波动率工具更直接。  
  - **候选代理**：用高 beta 风险资产（指数/行业篮子）的期权结构做反向表达，而不是裸空单票

### 观察信号（用于更新仓位）

- **信号 1（延迟约束）**：行业对低延迟基础设施的投入强度（并购/合作/Capex/技术迭代）  
- **信号 2（收入结构）**：交易所/数据业务的经常性收入占比与抗周期性  
- **信号 3（评测）**：回测-实盘偏差是否收敛、是否能稳定归因（延迟/冲击/对手反应/数据质量）  
- **复盘频率**：每月（重大宏观事件期提高频率）

---

## Plan Prompt（可选）

本篇的 Plan Prompt 请直接使用 `AGENT.md` 的“Plan Prompt 模板（可选，尽量短）”，把“市场/策略/延迟预算/horizon/阈值”填进去即可。

---

## 关联猜想（meta）

- `H-0007`：自动化交易/实时系统存在“聪明 vs 快”的硬 Pareto：延迟与滑点会吞噬 alpha，必须先满足硬约束再谈更聪明。

