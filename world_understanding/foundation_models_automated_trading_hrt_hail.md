# 自动化交易的基础模型（HRT / HAIL）：在“智能 vs 速度”的 Pareto 前沿上做工程

> 这篇把 HRT（HAIL，Marc Khoury）在 ICML 2025 的分享梳理成可执行的世界理解：市场微观结构的对象是什么？为什么“更聪明”与“更快”天然冲突？时间切片为什么会抹平 alpha？预测视界为何决定你能用多大的模型？以及：你该如何写出退出条件与下一步实验。
>
> 来源 digest：`sources/2026-01-19_hrt_hail_foundation_models_automated_trading_icml_2025.md`（演讲链接：`https://icml.cc/virtual/2025/46791`）

---

## 概述（这篇解决什么选择/误区）

这篇主要解决三类常见误区：

- **误区 A：把“价格”当成单一数值**：忽视 LOB 这一市场供需意图的主对象。
- **误区 B：只谈模型不谈延迟**：在自动化交易里，推理延迟会直接把 alpha 吃掉（滑点/错过机会），模型再聪明也可能不可上线。
- **误区 C：只谈回测不谈仿真缺口**：市场非平稳、非零和且无完美仿真器；回测无法复刻市场冲击与对手反应。

核心结论：**金融“基础模型”不是单点算法突破，而是算法 + 数据 + 基础设施 + 延迟工程的系统工程**。

---

## 框架/模型（1–3 个，给出使用条件）

### 1) Smart vs Fast：交易系统的 Pareto 前沿

- **更聪明（Smarter）**：更复杂模型可捕捉非线性/隐性特征，提取更深 alpha
- **更快（Faster）**：更低延迟系统能抢显性机会、减少滑点
- **硬约束**：更多 compute 通常意味着更高推理延迟（inference latency）

**适用**：做 tick/秒级到分钟级的预测与执行系统，尤其是对延迟敏感的策略。  
**不适用**：你做的是低频、延迟不敏感、成交影响较小的场景（但仍需验证）。

### 2) 时间 vs 事件：tokenization 决定你看见什么

- 金融事件是**非均匀**的：某些时刻 burst，其他时刻稀疏
- **时间切片（time-based）**容易“平滑掉”微观结构细节
- **事件切片（event/tick-based）**更贴近市场本质，但对模型架构与推理效率提出更高要求

**适用**：你在处理 LOB、逐笔成交、逐事件更新等微观结构任务。  
**不适用**：宏观周期、日级别、事件密度低且你明确不需要微观结构细节。

### 3) Horizon 困境：视界决定信噪比、延迟与有效样本量

选择预测目标会“锁死”你能用的模型复杂度：

- **极短 horizon（下一笔/下一跳）**：信号相对更可用，但延迟要求极高 → 模型必须轻量
- **长 horizon（小时级）**：允许大模型，但有效样本量下降 + 信噪比更低 → 过拟合风险上升
- **中间地带（如 1 分钟）**：看似信号丰富，但可能同时卡在“大模型推理太慢”的工程瓶颈

**适用**：你在选目标函数、评估 scaling law 是否值得、决定数据与算力投入方向。  
**不适用**：你把目标固定死且不愿为它改变系统结构与评测方式。

---

## 材料分类与索引

- **类型**：演讲内容的二手梳理总结
- **主题**：市场微观结构（LOB）、策略（做市/吃单）、延迟工程、模型架构选型、tokenization、预测视界、scaling laws、无完美仿真器、特征工程
- **可信度**：
  - 第一手/二手：二手梳理（需以演讲/公开材料核验关键数字）
  - 可追溯性：可追溯到演讲链接与梳理文本；细节可能被简化
  - 利益相关：交易公司叙事可能强调自身优势（数据/算力/工程）
- **输出去向**：`world_understanding/`；可衍生 `checklists/`

---

## 降维解剖（把“交易基础模型”压成可计算骨架）

### 第一性扫描（事实/约束/资源/风险）

- LOB 定义了价格的“结构”，并承载供需意图
- 延迟是硬约束：推理越慢，机会越容易被市场吞噬
- 市场非平稳且对手会反应：回测无法完美复刻冲击与博弈
- 金融信噪比低：不靠人类直觉基线，需要从一开始就超人化

### 根本问题 $\\mathcal{O}$：你在最大化什么？

一个可执行的目标函数版本：

- **最大化**：风险调整后的预期收益（alpha） × 可实现性（执行成功率）
- **约束**：推理延迟预算、滑点与冲击成本、非平稳鲁棒性、合规与风险上限、工程可维护性

### 核心变量（≤10）+ 算子（≤5）

- **变量**：spread、流动性、订单到达强度（burst）、horizon、信噪比、有效样本量、推理延迟、成交滑点、逆向选择风险、回测-实盘偏差。
- **算子**：特征提取（流→向量）、表示学习（time/event）、预测（方向/强度）、执行（下单/撤单）、评测（回测+在线监控）。

### 阶段切换信号（3 个）

1) 你能用同一套评测把“更聪明”与“更快”的权衡量化（而不是拍脑袋）  
2) 你能证明 tokenization 的改变带来可重复的收益（而非过拟合）  
3) 你能把回测与实盘偏差拆成可解释的组件（冲击/延迟/对手反应）

---

## 比较思考（发展史 × 情景 × 信号）

### 结构相似的祖先（机制类比）

- **语音/视频流系统**：编码方式（时间 vs 事件）决定你保留什么信息；延迟预算是硬约束。
- **实时推荐/广告竞价**：模型更强但延迟更高时，收益可能被竞价与时延吞掉，系统工程决定上限。

### 未来情景（保守/基准/激进）+ 观察信号（假设/推演）

- **保守**：大模型主要用于中低频或离线研究，低延迟场景仍由强归纳偏置的轻量模型主导。  
  - 信号：推理成本下降不够快；低延迟系统更多依赖手工结构与特征。
- **基准**：架构创新（更高效 attention/更强记忆）+ 工程优化，让更大模型进入更短 horizon。  
  - 信号：出现稳定可复现的低延迟 transformer/混合架构；线上收益可回归。
- **激进**：形成跨资产通用的“金融基础模型”，在多个 horizon 上都能给出可交易的优势。  
  - 信号：跨资产迁移有效；在非平稳切换中保持鲁棒；对手适应下仍可持续。

---

## 尽头坐标（唐诺）

### 远方尽头

在可控风险与可回归评测下，把“可交易的预测能力”系统性地产出，并能在不同资产与不同市场状态下迁移与迭代。

### 现实尽头（停止处）

- **延迟尽头**：模型收益被推理延迟与滑点吞噬
- **视界尽头**：horizon 太长导致有效样本量不足、过拟合；太短又跑不动复杂模型
- **评测尽头**：回测无法复刻冲击/对手反应，导致线上崩塌
- **数据尽头**：清洗、对齐与特征提取不足，模型看见的是噪音

### 退出条件 + 重启条件

- **退出条件（停机点）**
  - 在固定延迟预算下，模型升级带来的收益 < 滑点/冲击增加带来的损失（连续 ___ 周）
  - 回测收益与线上收益持续背离（偏差 > ___%，持续 ___ 次版本）
  - 模型对市场状态切换敏感，切换后损失超过风险上限（___）
- **重启条件**
  - 建立能解释偏差的归因链（延迟/冲击/对手反应/数据质量）
  - 形成 tokenization/架构/执行三者协同的改进方案，并在回归集上稳定收益

---

## 短/中/长期利益（1–3 个月 / 1–3 年 / 5–10 年）

- **短期**：把延迟预算、horizon、tokenization 写进同一张指标板；建立“回测-线上偏差”的归因模板
- **中期**：探索混合架构（长上下文 + 低延迟更新）；把数据清洗与特征工程系统化
- **长期**：跨资产基础模型与更稳健的在线评测体系共进，形成可迁移的金融表征与执行系统

---

## MUST / SHOULD / MAY 清单

- **MUST**
  - 明确延迟预算（P95/P99）与滑点容忍度，并把它们当硬约束
  - 明确 horizon 与有效样本量的关系，并为过拟合写退出条件
  - 对回测与线上偏差建立归因与回归（否则你在优化幻觉）
- **SHOULD**
  - 对比 time-based vs event-based 表示，并用同一评测框架量化差异
  - 对模型架构做“推理成本曲线”评估（序列长度增长下的成本/延迟）
  - 保留必要的特征工程，把流数据转成可学习表征
- **MAY**
  - 用更高效的 attention / 更强记忆机制探索“更大模型进更短 horizon”
  - 设计对手反应与冲击的近似评测（哪怕不完美，也要可回归）

---

## 练习（可复制填写）

- 我的策略形态：做市 / 吃单 / 混合（选一）  
- 我的延迟预算：P95 ___ 微秒 / P99 ___ 微秒  
- 我的预测 horizon：___  
- 我的 tokenization：time-based / event-based  
- 我最担心的尽头：延迟 / 视界有效样本量 / 回测偏差 / 数据质量（选一）  
- 退出条件（可观测）：__________  
- 重启条件（证据门槛）：__________

---

## Plan Prompt（可直接复制给 Agent 执行｜小成本验证）

```text
你是执行代理。请在不编造信息的前提下，帮我把“HRT/HAIL 自动化交易基础模型”的观点落到我的具体场景里，完成一次小成本验证。

## 背景
我的资产/市场：<例如：美股/期货/加密/外汇>
我的策略形态：<做市/吃单/混合>
我的延迟预算：<P95/P99>
我的预测目标（horizon）：<tick/秒/分钟/小时>

## 目标（要拿到的证据）
- 证据1：画出 Smart vs Fast 的权衡表（至少 3 个模型/系统点），并给出可比指标（收益、滑点、延迟）
- 证据2：给出 time-based vs event-based 的最小对比实验（样本、指标、判定标准）
- 证据3：给出 horizon 选择的有效样本量/过拟合风险说明，并写出退出条件与重启条件
- 证据4：输出一段可直接粘贴到 `worksheets/decision_one_pager.md` 的一页总结

## 约束
- 时间盒：90 分钟
- 投入上限：<钱/人天/算力>
- 隐私：不要写入任何真实个人隐私或敏感信息

## 你要做的事
1) 把最危险假设写成可证伪陈述（3 条）
2) 设计最小实验（动作+成本+预期信号+判定标准）
3) 写出退出条件与重启条件（阈值必须可观测）
4) 输出一页总结（事实/假设/风险/下一步/退出与重启/观察信号）
```

